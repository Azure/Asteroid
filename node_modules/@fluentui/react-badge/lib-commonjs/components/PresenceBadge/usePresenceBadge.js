"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.usePresenceBadge_unstable = void 0;

const React = /*#__PURE__*/require("react");

const react_utilities_1 = /*#__PURE__*/require("@fluentui/react-utilities");

const presenceIcons_1 = /*#__PURE__*/require("./presenceIcons");

const index_1 = /*#__PURE__*/require("../Badge/index");

const iconMap = (status, outOfOffice, size) => {
  switch (status) {
    case 'available':
      return outOfOffice ? presenceIcons_1.presenceAvailableRegular[size] : presenceIcons_1.presenceAvailableFilled[size];

    case 'away':
      return outOfOffice ? presenceIcons_1.presenceOfflineRegular[size] : presenceIcons_1.presenceAwayFilled[size];

    case 'busy':
      return outOfOffice ? presenceIcons_1.presenceUnknownRegular[size] : presenceIcons_1.presenceBusyFilled[size];

    case 'do-not-disturb':
      return outOfOffice ? presenceIcons_1.presenceDndRegular[size] : presenceIcons_1.presenceDndFilled[size];

    case 'offline':
      return presenceIcons_1.presenceOfflineRegular[size];

    case 'out-of-office':
      return presenceIcons_1.presenceOofRegular[size];

    case 'unknown':
      return presenceIcons_1.presenceUnknownRegular[size];
  }
};

const DEFAULT_STRINGS = {
  busy: 'busy',
  'out-of-office': 'out of office',
  away: 'away',
  available: 'available',
  offline: 'offline',
  'do-not-disturb': 'do not disturb',
  unknown: 'unknown'
};
/**
 * Returns the props and state required to render the component
 */

const usePresenceBadge_unstable = (props, ref) => {
  const {
    size = 'medium',
    status = 'available',
    outOfOffice = false
  } = props;
  const statusText = DEFAULT_STRINGS[status];
  const oofText = props.outOfOffice && props.status !== 'out-of-office' ? ` ${DEFAULT_STRINGS['out-of-office']}` : '';
  const IconElement = iconMap(status, outOfOffice, size);
  const state = { ...index_1.useBadge_unstable({
      'aria-label': statusText + oofText,
      role: 'img',
      ...props,
      size,
      icon: react_utilities_1.resolveShorthand(props.icon, {
        defaultProps: {
          children: IconElement ? React.createElement(IconElement, null) : null
        },
        required: true
      })
    }, ref),
    status,
    outOfOffice
  };
  return state;
};

exports.usePresenceBadge_unstable = usePresenceBadge_unstable;
//# sourceMappingURL=usePresenceBadge.js.map