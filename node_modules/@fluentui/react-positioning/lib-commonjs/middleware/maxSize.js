"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.maxSize = void 0;

const dom_1 = /*#__PURE__*/require("@floating-ui/dom");

const index_1 = /*#__PURE__*/require("../utils/index");

function maxSize(autoSize) {
  return {
    name: 'maxSize',
    fn: async middlewareArguments => {
      const {
        placement,
        rects,
        elements,
        middlewareData
      } = middlewareArguments;
      const basePlacement = index_1.parseFloatingUIPlacement(placement).side;
      const overflow = await dom_1.detectOverflow(middlewareArguments);
      const {
        x,
        y
      } = middlewareData.shift || {
        x: 0,
        y: 0
      };
      const {
        width,
        height
      } = rects.floating;
      const widthProp = basePlacement === 'left' ? 'left' : 'right';
      const heightProp = basePlacement === 'top' ? 'top' : 'bottom';
      const applyMaxWidth = autoSize === 'always' || autoSize === 'width-always' || overflow[widthProp] > 0 && (autoSize === true || autoSize === 'width');
      const applyMaxHeight = autoSize === 'always' || autoSize === 'height-always' || overflow[heightProp] > 0 && (autoSize === true || autoSize === 'height');

      if (applyMaxWidth) {
        elements.floating.style.maxWidth = `${width - overflow[widthProp] - x}px`;
      }

      if (applyMaxHeight) {
        elements.floating.style.maxHeight = `${height - overflow[heightProp] - y}px`;
      }

      return {};
    }
  };
}

exports.maxSize = maxSize;
//# sourceMappingURL=maxSize.js.map