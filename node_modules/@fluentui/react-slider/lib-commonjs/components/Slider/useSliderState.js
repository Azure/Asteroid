"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useSliderState_unstable = void 0;

const react_utilities_1 = /*#__PURE__*/require("@fluentui/react-utilities");

const react_shared_contexts_1 = /*#__PURE__*/require("@fluentui/react-shared-contexts");

const useSliderStyles_1 = /*#__PURE__*/require("./useSliderStyles");

const {
  sliderStepsPercentVar,
  sliderProgressVar,
  sliderDirectionVar
} = useSliderStyles_1.sliderCSSVars;

const getPercent = (value, min, max) => {
  return max === min ? 0 : (value - min) / (max - min) * 100;
};

const useSliderState_unstable = (state, props) => {
  const {
    defaultValue = 0,
    min = 0,
    max = 100,
    step,
    value
  } = props;
  const {
    dir
  } = react_shared_contexts_1.useFluent_unstable();
  const [currentValue, setCurrentValue] = react_utilities_1.useControllableState({
    state: value !== undefined ? react_utilities_1.clamp(value, min, max) : undefined,
    defaultState: react_utilities_1.clamp(defaultValue, min, max),
    initialState: 0
  });
  const valuePercent = getPercent(currentValue, min, max);
  const inputOnChange = state.input.onChange;
  const propsOnChange = props.onChange;
  const onChange = react_utilities_1.useEventCallback(ev => {
    const newValue = Number(ev.target.value);
    setCurrentValue(react_utilities_1.clamp(newValue, min, max));

    if (inputOnChange && inputOnChange !== propsOnChange) {
      inputOnChange(ev);
    } else if (propsOnChange) {
      propsOnChange(ev, {
        value: newValue
      });
    }
  });
  const rootVariables = {
    [sliderDirectionVar]: state.vertical ? '0deg' : dir === 'ltr' ? '90deg' : '270deg',
    [sliderStepsPercentVar]: step && step > 0 ? `${step * 100 / (max - min)}%` : '',
    [sliderProgressVar]: `${valuePercent}%`
  }; // Root props

  state.root.style = { ...rootVariables,
    ...state.root.style
  }; // Input Props

  state.input.value = currentValue;
  state.input.onChange = onChange;
  return state;
};

exports.useSliderState_unstable = useSliderState_unstable;
//# sourceMappingURL=useSliderState.js.map